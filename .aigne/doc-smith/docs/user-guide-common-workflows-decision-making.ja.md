# 意思決定

「マネージャー」Agent がリクエストを分析し、どの特化型 Agent がタスクの処理に最適かを判断するシナリオを示します。

## 概要

多くの現実世界のシナリオでは、単一の AI Agent では不十分です。複雑な問題には、多くの場合、特化型 Agent のチームが必要となり、それぞれが特定のドメインの専門家です。意思決定ワークフローは、ルーターまたはトリアージパターンとしても知られ、「マネージャー」Agent を導入することでこの問題に対処します。

「マネージャー」Agent の唯一の責任は、受信したリクエストを分析し、その意図を理解し、チーム内で最も適切な専門家 Agent にルーティングすることです。これは、顧客の問題を聞いて、テクニカルサポート、請求、営業など、適切な部署に繋ぐ顧客サービスディスパッチャーに似ています。

このパターンは、より効率的でインテリジェントなシステムを構築します。すべてをこなそうとする単一のジェネラリスト Agent の代わりに、各メンバーが指定されたタスクに秀でた、協調したチームを持つことになります。

## 仕組み

ワークフローは、ユーザーがリクエストを送信すると開始されます。中央ルーターとして機能する「マネージャー」Agent がこのリクエストを受け取ります。その指示と利用可能な「ツール」（専門家 Agent）に基づいて、どの専門家がクエリを処理するのに最適かを判断します。その後、リクエストは選択された専門家に渡され、それがリクエストを処理して最終的な出力を生成します。

例えば、ユーザーが「注文の状況はどうなっていますか？」と尋ねた場合、「マネージャー」Agent はクエリを「注文状況」Agent にルーティングします。ユーザーが「パスワードをリセットするにはどうすればよいですか？」と尋ねた場合、それは「アカウントサポート」Agent にルーティングされます。

```d2
direction: down

User: {
  shape: c4-person
}

Manager-Agent: {
  label: "マネージャー Agent\n（ルーター）"
  shape: rectangle
}

Specialist-Agents: {
  label: "専門家 Agent のチーム"
  shape: rectangle
  style: {
    stroke-dash: 4
  }
  grid-columns: 3

  Order-Status: { label: "注文状況 Agent" }
  Account-Support: { label: "アカウントサポート Agent" }
  Technical-Support: { label: "テクニカルサポート Agent" }
}

User -> Manager-Agent: "1. リクエストを送信"
Manager-Agent -> Specialist-Agents.Order-Status: "2. 意図に基づいてルーティング\n（例：「注文状況」）"
Manager-Agent -> Specialist-Agents.Account-Support: "2. 意図に基づいてルーティング\n（例：「パスワードリセット」）"
Manager-Agent -> Specialist-Agents.Technical-Support: "2. 意図に基づいてルーティング\n（例：「技術的な問題」）"

Specialist-Agents.Order-Status -> User: "3. 処理して出力を返す"
Specialist-Agents.Account-Support -> User: "3. 処理して出力を返す"
Specialist-Agents.Technical-Support -> User: "3. 処理して出力を返す"
```

## ユースケース

このワークフローは、以下のような場合に非常に効果的です。

- **インテリジェントなカスタマーサポート：** 顧客の問い合わせを適切な部署（例：テクニカルサポート、請求、営業）に自動的にルーティングします。
- **多機能アシスタント：** スケジューリング、データ分析、コンテンツ作成などのタスクをさまざまな特化型 Agent に委任できる単一のアシスタントを作成します。
- **コンテンツモデレーション：** 受信コンテンツを分類し、その性質（例：スパム、ヘイトスピーチ、不適切なコンテンツ）に基づいてさまざまなモデレーションキューに送信します。
- **複雑なクエリの処理：** 複雑なクエリをサブタスクに分解し、それぞれを特定の Agent にルーティングして処理します。

## まとめ

意思決定ワークフローは、特化型 AI Agent のチームを編成するための強力なパターンです。マネージャー Agent を使用してタスクをトリアージおよびルーティングすることで、個々の特化した Agent の強みを活かした、より洗練され、スケーラブルで効率的な AI アプリケーションを構築できます。

技術的な実装についてさらに詳しく知りたい場合は、[Team Agent](./developer-guide-agents-team-agent.md) および [AI Agent](./developer-guide-agents-ai-agent.md) のドキュメントを参照してください。